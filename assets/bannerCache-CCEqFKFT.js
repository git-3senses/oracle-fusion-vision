import{j as e}from"./radix-yKnm7QCl.js";import{r as s}from"./vendor-CU0uM7a2.js";import{B as w}from"./button-DKt0VdM1.js";import{c as I}from"./index-3w8SJubk.js";import{u as J,a7 as X,P,a8 as _,a9 as H,aa as T}from"./icons-D2oHHS-h.js";const A=({threshold:a=.1,rootMargin:t="50px",enabled:d=!0}={})=>{const[c,o]=s.useState(!1),[m,v]=s.useState(!1),[f,i]=s.useState(!1),r=s.useRef(null),n=s.useRef(null),u=s.useCallback(()=>{!d||!r.current||n.current||(n.current=new IntersectionObserver(([h])=>{h.isIntersecting?(o(!0),r.current&&!m&&r.current.load()):(o(!1),r.current&&f&&(r.current.pause(),i(!1)))},{threshold:a,rootMargin:t}),n.current.observe(r.current))},[d,a,t,m,f]),x=s.useCallback(()=>{n.current&&(n.current.disconnect(),n.current=null)},[]);s.useEffect(()=>(u(),()=>{x()}),[u,x]);const b=s.useCallback(()=>{v(!0),c&&r.current&&r.current.play().then(()=>{i(!0)}).catch(()=>{})},[c]),p=s.useCallback(()=>{i(!0)},[]),j=s.useCallback(()=>{i(!1)},[]);return{videoRef:r,isInView:c,isLoaded:m,isPlaying:f,handleVideoLoad:b,handlePlay:p,handlePause:j}},G=a=>{const t=a.split("?")[0].toLowerCase();return t.endsWith(".webm")?"video/webm":t.endsWith(".mov")||t.endsWith(".qt")?"video/quicktime":t.endsWith(".m3u8")?"application/x-mpegURL":t.endsWith(".mpd")?"application/dash+xml":t.endsWith(".ogg")||t.endsWith(".ogv")?"video/ogg":"video/mp4"},ee=({src:a,poster:t,alt:d,className:c,autoPlay:o=!0,muted:m=!0,loop:v=!0,controls:f=!1,lazyLoad:i=!0,onLoadStart:r,onLoadEnd:n,onError:u})=>{const[x,b]=s.useState(!0),[p,j]=s.useState(!1),[h,S]=s.useState(m),[V,k]=s.useState(!1),{videoRef:l,isInView:L,isLoaded:M,isPlaying:y,handleVideoLoad:N,handlePlay:O,handlePause:R}=A({enabled:i,threshold:.25,rootMargin:"100px"}),W=s.useCallback(()=>{b(!0),r==null||r()},[r]),F=s.useCallback(()=>{b(!1),n==null||n(),N()},[n,N]),z=s.useCallback(C=>{console.error("Video load error for:",a,C),j(!0),b(!1),u==null||u(C)},[u,a]),B=s.useCallback(()=>{l.current&&(y?l.current.pause():l.current.play().catch(()=>{}))},[y,l]),q=s.useCallback(()=>{l.current&&(l.current.muted=!h,S(!h))},[h,l]),D=s.useCallback(()=>{l.current&&(document.fullscreenElement?document.exitFullscreen():l.current.requestFullscreen().catch(()=>{}))},[l]),E=s.useCallback(()=>{k(!0)},[]),U=s.useCallback(()=>{k(!1)},[]);return p?e.jsx("div",{className:I("flex items-center justify-center bg-muted text-muted-foreground",c),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"⚠️"}),e.jsx("p",{className:"text-sm",children:"Failed to load video"})]})}):e.jsxs("div",{className:I("relative overflow-hidden group",c),onMouseEnter:E,onMouseLeave:U,children:[x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading video..."})]})}),e.jsxs("video",{ref:l,className:"w-full h-full object-cover",poster:t,autoPlay:o&&!i,muted:m,loop:v,playsInline:!0,controls:f,crossOrigin:"anonymous",onLoadStart:W,onLoadedData:F,onPlay:O,onPause:R,onError:z,style:{display:x?"none":"block"},children:[e.jsx("source",{src:a,type:G(a)}),e.jsx("source",{src:a,type:"video/mp4"}),e.jsx("source",{src:a,type:"video/webm"}),t&&e.jsx("img",{src:t,alt:d,className:"w-full h-full object-cover"})]}),!f&&M&&(V||!o)&&e.jsx("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(w,{variant:"secondary",size:"lg",onClick:B,className:"bg-black/50 hover:bg-black/70 text-white border-none",children:y?e.jsx(X,{className:"h-6 w-6"}):e.jsx(P,{className:"h-6 w-6"})}),e.jsx(w,{variant:"secondary",size:"sm",onClick:q,className:"bg-black/50 hover:bg-black/70 text-white border-none",children:h?e.jsx(_,{className:"h-4 w-4"}):e.jsx(H,{className:"h-4 w-4"})}),e.jsx(w,{variant:"secondary",size:"sm",onClick:D,className:"bg-black/50 hover:bg-black/70 text-white border-none",children:e.jsx(T,{className:"h-4 w-4"})})]})}),i&&!L&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Video will load when visible"})]})})]})},g="hero_banner_cache:";function se(a,t){try{localStorage.setItem(g+a,JSON.stringify(t)),localStorage.setItem(g+a+":updated",String(Date.now()))}catch{}}function te(a){try{const t=localStorage.getItem(g+a);return t?JSON.parse(t):null}catch{return null}}function ae(a,t){const d=g+a+":updated",c=o=>{o.key===d&&t()};return window.addEventListener("storage",c),()=>window.removeEventListener("storage",c)}export{ee as O,te as l,ae as o,se as s};
