import{j as l}from"./radix-yKnm7QCl.js";import{r}from"./vendor-CU0uM7a2.js";import{B as Q}from"./button-Co8cv8NH.js";import{u as J,a as K,s as n}from"./index-CgoZkpF6.js";import{l as L,o as X,O as Y}from"./bannerCache-CCcOS5ND.js";import{l as g,o as Z}from"./badge-BIHS689z.js";import{q as D,c as ee}from"./icons-D2oHHS-h.js";const $="/assets/hero-modern-DeMzjQrm.jpg",ne=({pageName:i,defaultTitle:v="Welcome",defaultSubtitle:w="",showUpload:C=!1,defaultCtaText:z,defaultCtaLink:I})=>{const[t,m]=r.useState(null),[F,f]=r.useState(!0),[j,k]=r.useState(!1),{toast:u}=J(),[h,p]=r.useState(.7),[O,_]=r.useState("white"),{applyTemporaryTheme:c}=K();r.useEffect(()=>(N(),(async()=>{try{const{data:s}=await n.from("site_settings").select("setting_key, setting_value").in("setting_key",["hero_default_overlay_opacity","hero_default_text_color"]),e=new Map;(s||[]).forEach(d=>e.set(d.setting_key,d.setting_value));const o=parseFloat(e.get("hero_default_overlay_opacity")||"0.7");Number.isNaN(o)||p(Math.min(1,Math.max(0,o)));const a=e.get("hero_default_text_color");a&&_(a)}catch{const s=g();if(s){const e=parseFloat(s.hero_default_overlay_opacity||"0.7");Number.isNaN(e)||p(Math.min(1,Math.max(0,e)));const o=s.hero_default_text_color;o&&_(o)}}})(),(async()=>{try{const s=`page_theme_${i}`,{data:e,error:o}=await n.from("site_settings").select("setting_value").eq("setting_key",s).maybeSingle();if(o){c(null);return}const a=((e==null?void 0:e.setting_value)||"").toLowerCase();c(a==="light"||a==="dark"?a:null)}catch{const s=g(),e=`page_theme_${i}`,o=((s==null?void 0:s[e])||"").toLowerCase();c(o==="light"||o==="dark"?o:null)}})(),()=>c(null)),[i]),r.useEffect(()=>{const s=Z(()=>{const e=g();if(e){const o=parseFloat(e.hero_default_overlay_opacity||`${h}`);Number.isNaN(o)||p(Math.min(1,Math.max(0,o)));const a=e.hero_default_text_color;a&&_(a)}});return()=>s()},[h]);const N=async()=>{try{const{data:s,error:e}=await n.from("hero_banners").select("*").eq("page_name",i).single();if(e&&e.code!=="PGRST116"){console.error("Error fetching banner data:",e);const o=L(i);if(o){m({id:"cached",title:o.title,subtitle:o.subtitle,media_type:o.media_type,media_url:o.media_url,overlay_opacity:o.overlay_opacity,text_color:o.text_color,cta_text:o.cta_text,cta_link:o.cta_link}),f(!1);return}f(!1);return}m(s||null)}catch(s){console.error("Error:",s);const e=L(i);e&&m({id:"cached",title:e.title,subtitle:e.subtitle,media_type:e.media_type,media_url:e.media_url,overlay_opacity:e.overlay_opacity,text_color:e.text_color,cta_text:e.cta_text,cta_link:e.cta_link})}finally{f(!1)}};r.useEffect(()=>{const s=X(i,N);return()=>s()},[i]);const P=async s=>{var d;const e=(d=s.target.files)==null?void 0:d[0];if(!e)return;const o=e.type.startsWith("video/"),a=e.type.startsWith("image/");if(!o&&!a){u({title:"Invalid file type",description:"Please select an image or video file",variant:"destructive"});return}if(e.size>50*1024*1024){u({title:"File too large",description:"Please select a file under 50MB",variant:"destructive"});return}k(!0);try{const y=e.name.split(".").pop(),S=`${i}-${Date.now()}.${y}`,{data:te,error:B}=await n.storage.from("hero-media").upload(S,e);if(B)throw B;const{data:{publicUrl:H}}=n.storage.from("hero-media").getPublicUrl(S),A={page_name:i,title:(t==null?void 0:t.title)||v,subtitle:(t==null?void 0:t.subtitle)||w,media_type:o?"video":"image",media_url:H,overlay_opacity:(t==null?void 0:t.overlay_opacity)||.7,text_color:(t==null?void 0:t.text_color)||"white",cta_text:t==null?void 0:t.cta_text,cta_link:t==null?void 0:t.cta_link},{data:G,error:T}=await n.from("hero_banners").upsert(A,{onConflict:"page_name"}).select().single();if(T)throw T;m(G),u({title:"Media uploaded successfully",description:`${o?"Video":"Image"} has been set as hero banner`})}catch(y){console.error("Upload error:",y),u({title:"Upload failed",description:"There was an error uploading your file",variant:"destructive"})}finally{k(!1)}},V=s=>{if(s.startsWith("#")){const e=document.getElementById(s.substring(1));e&&e.scrollIntoView({behavior:"smooth"})}else if(s){const e=document.getElementById(s);e&&e.scrollIntoView({behavior:"smooth"})}};if(F)return l.jsx("section",{className:"relative min-h-[70vh] sm:min-h-screen flex items-center justify-center bg-gradient-hero",children:l.jsx("div",{className:"animate-pulse text-white text-lg",children:"Loading..."})});const W=(t==null?void 0:t.title)||v,b=(t==null?void 0:t.subtitle)||w,x=t==null?void 0:t.media_url,q=(t==null?void 0:t.media_type)||"image",R=(t==null?void 0:t.overlay_opacity)??h,E=(t==null?void 0:t.text_color)||O,U=(t==null?void 0:t.cta_text)??z??void 0,M=(t==null?void 0:t.cta_link)??I??void 0;return l.jsxs("section",{className:"relative min-h-[70vh] sm:min-h-screen flex items-center justify-center overflow-hidden",children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[q==="video"&&x?l.jsx(Y,{src:x,poster:$,alt:`${i} hero background video`,className:"w-full h-full",autoPlay:!0,muted:!0,loop:!0,controls:!1,lazyLoad:!1,onLoadStart:()=>{},onLoadEnd:()=>{},onError:s=>{}}):l.jsx("img",{src:x||$,alt:`${i} hero background`,className:"w-full h-full object-cover",loading:"eager"}),l.jsx("div",{className:"absolute inset-0 bg-primary dark:bg-black",style:{opacity:R}})]}),C&&l.jsx("div",{className:"absolute top-4 right-4 z-20",children:l.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-black/50 text-white rounded-lg cursor-pointer hover:bg-black/70 transition-colors",children:[l.jsx(D,{className:"h-4 w-4 mr-2"}),j?"Uploading...":"Upload Media",l.jsx("input",{type:"file",accept:"image/*,video/*",onChange:P,className:"hidden",disabled:j})]})}),l.jsx("div",{className:"relative z-10 container mx-auto px-6 lg:px-8 text-center",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsx("h1",{className:"text-4xl lg:text-6xl font-bold mb-6 animate-fade-in",style:{color:E},children:W}),b&&l.jsx("p",{className:"text-lg lg:text-xl max-w-2xl mx-auto mb-8 leading-relaxed animate-slide-up",style:{color:E,opacity:.9,animationDelay:"0.2s"},children:b}),U&&M&&l.jsx("div",{className:"animate-scale-in",style:{animationDelay:"0.4s"},children:l.jsxs(Q,{variant:"accent",size:"xl",onClick:()=>V(M),className:"hover-lift group",children:[U,l.jsx(ee,{className:"h-5 w-5 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})})]})};export{ne as H};
