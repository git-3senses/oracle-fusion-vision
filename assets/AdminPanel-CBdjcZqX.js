import{j as e,k as xt,I as Xt,l as ht,m as Zt,c as es,n as gt,o as pt,O as He,u as jt,W as ts,p as Je,e as ss,q as Ve,r as We,s as Ge,t as ft,v as as,w as vt}from"./radix-yKnm7QCl.js";import{r as o,R as is}from"./vendor-CU0uM7a2.js";import{B as w,b as _t}from"./button-Co8cv8NH.js";import{L as _,I as E}from"./label-CTSzVvqU.js";import{C as k,b as P,c as L,a as D}from"./card-D-AsCHED.js";import{B as X,s as ct,T as ns}from"./badge-BIHS689z.js";import{T as Ie,a as Te,b as V,c as W}from"./tabs-CQ0iRw7G.js";import{c as M,u as ne,s as f}from"./index-CgoZkpF6.js";import{T as ie,S as Le,a as ze,b as Re,c as Me,d as ke}from"./select-YWrqtOXR.js";import{a as rs}from"./utils-B2rm_Apj.js";import{F as Fe,u as Pe,q as dt,v as yt,w as ls,x as os,y as cs,z as le,E as Nt,I as ds,J as ye,K as wt,N as ce,O as ve,R as qe,V as Ne,Y as Ye,Z as Ke,G as ae,n as De,o as Qe,M as bt,_ as ms,$ as us,a0 as xs,a1 as Ae,d as Ee,X as St,h as hs,i as gs,a2 as Ct,S as ps,a3 as js,m as fs,a4 as vs}from"./icons-D2oHHS-h.js";import{O as mt,s as ut}from"./bannerCache-CCcOS5ND.js";import"./supabase-CbVNuAdk.js";import"./query-dX0FI0I0.js";import"./router-tS1r0LNX.js";const Ue=o.forwardRef(({className:a,...c},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:M("w-full caption-bottom text-sm",a),...c})}));Ue.displayName="Table";const $e=o.forwardRef(({className:a,...c},t)=>e.jsx("thead",{ref:t,className:M("[&_tr]:border-b",a),...c}));$e.displayName="TableHeader";const Be=o.forwardRef(({className:a,...c},t)=>e.jsx("tbody",{ref:t,className:M("[&_tr:last-child]:border-0",a),...c}));Be.displayName="TableBody";const _s=o.forwardRef(({className:a,...c},t)=>e.jsx("tfoot",{ref:t,className:M("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c}));_s.displayName="TableFooter";const _e=o.forwardRef(({className:a,...c},t)=>e.jsx("tr",{ref:t,className:M("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",a),...c}));_e.displayName="TableRow";const Y=o.forwardRef(({className:a,...c},t)=>e.jsx("th",{ref:t,className:M("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));Y.displayName="TableHead";const K=o.forwardRef(({className:a,...c},t)=>e.jsx("td",{ref:t,className:M("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));K.displayName="TableCell";const ys=o.forwardRef(({className:a,...c},t)=>e.jsx("caption",{ref:t,className:M("mt-4 text-sm text-muted-foreground",a),...c}));ys.displayName="TableCaption";const Xe=o.forwardRef(({className:a,value:c,...t},u)=>e.jsx(xt,{ref:u,className:M("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...t,children:e.jsx(Xt,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})}));Xe.displayName=xt.displayName;const Ns=rs("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),kt=o.forwardRef(({className:a,variant:c,...t},u)=>e.jsx("div",{ref:u,role:"alert",className:M(Ns({variant:c}),a),...t}));kt.displayName="Alert";const ws=o.forwardRef(({className:a,...c},t)=>e.jsx("h5",{ref:t,className:M("mb-1 font-medium leading-none tracking-tight",a),...c}));ws.displayName="AlertTitle";const Ft=o.forwardRef(({className:a,...c},t)=>e.jsx("div",{ref:t,className:M("text-sm [&_p]:leading-relaxed",a),...c}));Ft.displayName="AlertDescription";const bs=()=>{const[a,c]=o.useState(!1),[t,u]=o.useState(null),b=o.useCallback(async A=>(c(!0),new Promise(I=>{const g=document.createElement("video");g.preload="metadata",g.onloadedmetadata=()=>{g.duration;const y=A.size,j=y/(1024*1024);let x="medium",v=y,z="";j>100?(x="low",v=y*.3,z="File is very large. Consider compressing to reduce loading time."):j>50?(x="medium",v=y*.5,z="File size is large. Compression recommended for better performance."):j>20?(x="high",v=y*.7,z="Good size, minor compression could improve loading speed."):(x="high",v=y,z="File size is optimal for web delivery.");const T={currentSize:y,suggestedSize:v,quality:x,reason:z};u(T),c(!1),I(T)},g.src=URL.createObjectURL(A)})),[]),F=o.useCallback(A=>{const I=A.size/1048576,g=[];return I>50&&(g.push("Use H.264 codec with 1920x1080 resolution"),g.push("Set bitrate to 3-5 Mbps for good quality"),g.push("Keep frame rate at 30fps maximum"),g.push("Consider using HandBrake or FFmpeg for compression")),I>20&&(g.push("Remove audio track if not needed"),g.push("Trim unnecessary content from start/end")),g},[]);return{isAnalyzing:a,suggestion:t,analyzeVideo:b,getOptimizationTips:F}},Ze=({onFileSelect:a,onUploadProgress:c,uploadProgress:t=0,isUploading:u=!1,disabled:b=!1,maxSizeMB:F=50})=>{const[A,I]=o.useState(!1),[g,y]=o.useState(null),{isAnalyzing:j,suggestion:x,analyzeVideo:v,getOptimizationTips:z}=bs(),{toast:T}=ne(),U=l=>{const N=l.type.startsWith("video/"),C=l.type.startsWith("image/");if(!N&&!C)return"Please select a video or image file";const q=l.size/(1024*1024);return q>F?`File size (${q.toFixed(1)}MB) exceeds ${F}MB limit`:N&&!["video/mp4","video/webm","video/mov","video/avi"].includes(l.type)?"Please use MP4, WebM, MOV, or AVI format for videos":null},R=o.useCallback(async l=>{const N=U(l);if(N){T({title:"Invalid file",description:N,variant:"destructive"});return}y(l),l.type.startsWith("video/")&&await v(l)},[v,T,F]),p=o.useCallback(l=>{l.preventDefault(),l.stopPropagation(),l.type==="dragenter"||l.type==="dragover"?I(!0):l.type==="dragleave"&&I(!1)},[]),m=o.useCallback(l=>{if(l.preventDefault(),l.stopPropagation(),I(!1),b||u)return;const N=l.dataTransfer.files;N&&N[0]&&R(N[0])},[b,u,R]),h=o.useCallback(l=>{const N=l.target.files;N&&N[0]&&R(N[0]),l.target.value=""},[R]),n=o.useCallback(()=>{g&&a(g)},[g,a]),i=l=>`${(l/1048576).toFixed(1)} MB`,s=l=>{switch(l){case"high":return"bg-success text-success-foreground";case"medium":return"bg-orange-500 text-white";case"low":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return e.jsxs(k,{className:"w-full",children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Fe,{className:"h-5 w-5 mr-2"}),"Media Upload Optimizer"]})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-8 text-center transition-colors ${A?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-muted-foreground/50"} ${b||u?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:m,onClick:()=>{var l;return!b&&!u&&((l=document.getElementById("file-upload"))==null?void 0:l.click())},children:[e.jsx("input",{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:h,className:"hidden",disabled:b||u}),u?e.jsxs("div",{className:"space-y-3",children:[e.jsx(Pe,{className:"h-8 w-8 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading..."}),e.jsx(Xe,{value:t,className:"w-full max-w-xs mx-auto"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t,"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"h-8 w-8 mx-auto mb-3 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Drag & drop your video or image here, or click to browse"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Max file size: ",F,"MB • Supports: MP4, WebM, MOV, JPG, PNG"]})]})]}),g&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Fe,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:g.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i(g.size)," • ",g.type]})]})]}),x&&e.jsxs(X,{className:s(x.quality),children:[x.quality," quality"]})]}),j&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(Pe,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Analyzing video..."})]}),x&&e.jsxs(kt,{children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsx(Ft,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:x.reason}),x.currentSize!==x.suggestedSize&&e.jsxs("p",{className:"text-sm",children:["Potential size reduction: ",i(x.currentSize)," → ",i(x.suggestedSize)]})]})})]}),g.type.startsWith("video/")&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ls,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Optimization Tips:"})]}),e.jsx("div",{className:"text-xs text-muted-foreground space-y-1",children:z(g).map((l,N)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"text-primary mt-1",children:"•"}),e.jsx("span",{children:l})]},N))})]}),e.jsx(w,{onClick:n,disabled:u||b,className:"w-full",size:"lg",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Upload Media"]})})]})]})]})},Ss=({bucketName:a="hero-media",onFileSelect:c})=>{const[t,u]=o.useState([]),[b,F]=o.useState(!0),[A,I]=o.useState({used:0,total:1024*1024*1024}),[g,y]=o.useState(new Set),{toast:j}=ne();o.useEffect(()=>{x()},[a]);const x=async()=>{try{F(!0);const{data:i,error:s}=await f.storage.from(a).list("",{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(s)throw s;const l=(i==null?void 0:i.map(C=>({...C,id:C.name})))||[];u(l);const N=l.reduce((C,q)=>{var J;return C+(((J=q.metadata)==null?void 0:J.size)||0)},0);I(C=>({...C,used:N}))}catch(i){console.error("Error fetching files:",i),j({title:"Error",description:"Failed to load media files",variant:"destructive"})}finally{F(!1)}},v=async i=>{try{const{error:s}=await f.storage.from(a).remove([i]);if(s)throw s;j({title:"Success",description:"File deleted successfully"}),x()}catch(s){console.error("Error deleting file:",s),j({title:"Error",description:"Failed to delete file",variant:"destructive"})}},z=async i=>{try{const{data:s,error:l}=await f.storage.from(a).download(i);if(l)throw l;const N=URL.createObjectURL(s),C=document.createElement("a");C.href=N,C.download=i,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(N)}catch(s){console.error("Error downloading file:",s),j({title:"Error",description:"Failed to download file",variant:"destructive"})}},T=i=>{const{data:s}=f.storage.from(a).getPublicUrl(i);return s.publicUrl},U=i=>{const s=i/1048576;return s<1?`${(i/1024).toFixed(1)} KB`:`${s.toFixed(1)} MB`},R=i=>i!=null&&i.startsWith("video/")?e.jsx(Fe,{className:"h-5 w-5"}):i!=null&&i.startsWith("image/")?e.jsx(ye,{className:"h-5 w-5"}):e.jsx(Fe,{className:"h-5 w-5"}),p=i=>i!=null&&i.startsWith("video/")?"bg-blue-500 text-white":i!=null&&i.startsWith("image/")?"bg-green-500 text-white":"bg-gray-500 text-white",m=async()=>{if(g.size!==0)try{const{error:i}=await f.storage.from(a).remove(Array.from(g));if(i)throw i;j({title:"Success",description:`${g.size} files deleted successfully`}),y(new Set),x()}catch(i){console.error("Error deleting files:",i),j({title:"Error",description:"Failed to delete files",variant:"destructive"})}},h=i=>{const s=new Set(g);s.has(i)?s.delete(i):s.add(i),y(s)},n=A.used/A.total*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(os,{className:"h-5 w-5 mr-2"}),"Storage Usage"]})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Used: ",U(A.used)]}),e.jsxs("span",{children:["Total: ",U(A.total)]})]}),e.jsx(Xe,{value:n,className:"w-full"}),n>80&&e.jsxs("div",{className:"flex items-center space-x-2 text-orange-600",children:[e.jsx(cs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Storage usage is high"})]})]})})]}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Media Files (",t.length,")"]}),g.size>0&&e.jsxs(w,{variant:"destructive",size:"sm",onClick:m,children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Delete Selected (",g.size,")"]})]})}),e.jsx(D,{children:b?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"animate-pulse",children:"Loading files..."})}):t.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No media files found"}):e.jsx("div",{className:"space-y-2",children:t.map(i=>{var s,l,N,C,q;return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-colors ${g.has(i.name)?"bg-primary/10 border-primary":"hover:bg-muted"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:g.has(i.name),onChange:()=>h(i.name),className:"rounded"}),e.jsx("div",{className:"text-muted-foreground",children:R((s=i.metadata)==null?void 0:s.mimetype)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:i.name}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:U(((l=i.metadata)==null?void 0:l.size)||0)}),e.jsx(X,{className:p((N=i.metadata)==null?void 0:N.mimetype),children:((q=(C=i.metadata)==null?void 0:C.mimetype)==null?void 0:q.split("/")[1])||"unknown"}),e.jsx("span",{children:new Date(i.created_at).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{const J=T(i.name);window.open(J,"_blank")},children:e.jsx(Nt,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>z(i.name),children:e.jsx(ds,{className:"h-4 w-4"})}),c&&e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(i),children:"Select"}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>v(i.name),className:"text-destructive hover:text-destructive",children:e.jsx(le,{className:"h-4 w-4"})})]})]},i.id)})})})]})]})},Cs=()=>{const[a,c]=o.useState([]),[t,u]=o.useState(null),[b,F]=o.useState(!0),[A,I]=o.useState(!1),[g,y]=o.useState(!1),[j,x]=o.useState(0),[v,z]=o.useState(!1),[T,U]=o.useState("inherit"),{toast:R}=ne();o.useEffect(()=>{p()},[]),o.useEffect(()=>{(async()=>{if(t)try{const n=`page_theme_${t.page_name}`,{data:i,error:s}=await f.from("site_settings").select("setting_value").eq("setting_key",n).maybeSingle();if(s){U("inherit");return}const l=((i==null?void 0:i.setting_value)||"").toLowerCase();U(l==="light"||l==="dark"?l:"inherit")}catch{U("inherit")}})()},[t==null?void 0:t.id]);const p=async()=>{try{const{data:n,error:i}=await f.from("hero_banners").select("*").order("page_name");if(i)throw i;c(n||[]),n&&n.length>0&&u(n[0])}catch(n){console.error("Error fetching banners:",n),R({title:"Error",description:"Failed to load hero banners",variant:"destructive"})}finally{F(!1)}},m=async()=>{if(t){I(!0);try{const{error:n}=await f.from("hero_banners").update({title:t.title,subtitle:t.subtitle,overlay_opacity:t.overlay_opacity,text_color:t.text_color,cta_text:t.cta_text,cta_link:t.cta_link,media_type:t.media_type,media_url:t.media_url}).eq("id",t.id);if(n)throw n;R({title:"Success",description:"Hero banner updated successfully"});try{const i=`page_theme_${t.page_name}`;if(T==="inherit")await f.from("site_settings").delete().eq("setting_key",i);else{const{error:s}=await f.from("site_settings").upsert({setting_key:i,setting_value:T,setting_type:"text",description:`Theme override for ${t.page_name}`},{onConflict:"setting_key"});if(s)throw s}try{const s=localStorage.getItem("site_settings_cache"),l=s?JSON.parse(s):{};T==="inherit"?delete l[i]:l[i]=T,localStorage.setItem("site_settings_cache",JSON.stringify(l)),localStorage.setItem("site_settings_updated_at",String(Date.now()))}catch{}}catch(i){console.log("Page theme save optional error:",i)}try{ut(t.page_name,{title:t.title,subtitle:t.subtitle,media_type:t.media_type,media_url:t.media_url,overlay_opacity:t.overlay_opacity,text_color:t.text_color,cta_text:t.cta_text,cta_link:t.cta_link})}catch{}p()}catch(n){console.error("Error saving banner:",n),R({title:"Error",description:"Failed to save hero banner",variant:"destructive"})}finally{I(!1)}}},h=async n=>{if(!t)return;y(!0),x(0);const i=n.type.startsWith("video/");n.type.startsWith("image/");try{const s=n.name.split(".").pop(),l=`${t.page_name}-${Date.now()}.${s}`,N=setInterval(()=>{x(G=>Math.min(G+10,90))},200),{data:C,error:q}=await f.storage.from("hero-media").upload(l,n);if(clearInterval(N),q)throw q;x(95);const{data:{publicUrl:J}}=f.storage.from("hero-media").getPublicUrl(l),ee=t.media_url,{error:Q}=await f.from("hero_banners").update({media_type:i?"video":"image",media_url:J}).eq("id",t.id);if(Q)throw Q;u(G=>G?{...G,media_type:i?"video":"image",media_url:J}:null),x(100);try{ut(t.page_name,{title:t.title,subtitle:t.subtitle,media_type:i?"video":"image",media_url:J,overlay_opacity:t.overlay_opacity,text_color:t.text_color,cta_text:t.cta_text,cta_link:t.cta_link})}catch{}if(ee)try{const G="/object/public/hero-media/",te=ee.indexOf(G),de=te!==-1?ee.substring(te+G.length):ee;await f.storage.from("hero-media").remove([de])}catch(G){console.warn("Failed to remove previous hero media",G)}R({title:"Success",description:"Media uploaded and optimized successfully"}),p()}catch(s){console.error("Upload error:",s),R({title:"Error",description:"Failed to upload media",variant:"destructive"})}finally{y(!1),setTimeout(()=>x(0),1e3)}};return b?e.jsx("div",{className:"p-6",children:"Loading hero banner settings..."}):e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Pages"}),e.jsx("div",{className:"space-y-2",children:a.map(n=>e.jsx(k,{className:`cursor-pointer transition-colors ${(t==null?void 0:t.id)===n.id?"ring-2 ring-primary":""}`,onClick:()=>u(n),children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium capitalize",children:n.page_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:n.title})]}),e.jsx(X,{variant:n.media_url?"default":"secondary",children:n.media_type})]})})},n.id))})]}),t&&e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Edit ",t.page_name.charAt(0).toUpperCase()+t.page_name.slice(1)," Page"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>z(!v),children:[v?e.jsx(wt,{className:"h-4 w-4"}):e.jsx(Nt,{className:"h-4 w-4"}),v?"Edit":"Preview"]}),e.jsxs(w,{onClick:m,disabled:A,size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),A?"Saving...":"Save"]})]})]}),v?e.jsxs(k,{className:"relative h-96 overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[t.media_type==="video"&&t.media_url?e.jsx(mt,{src:t.media_url,className:"w-full h-full",autoPlay:!0,muted:!0,loop:!0,controls:!1,lazyLoad:!1}):t.media_url?e.jsx("img",{src:t.media_url,alt:"Hero background",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-hero"}),e.jsx("div",{className:"absolute inset-0 bg-primary dark:bg-black",style:{opacity:t.overlay_opacity}})]}),e.jsx("div",{className:"relative z-10 flex items-center justify-center h-full text-center p-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-4xl font-bold mb-4",style:{color:t.text_color},children:t.title}),t.subtitle&&e.jsx("p",{className:"text-lg mb-6",style:{color:t.text_color,opacity:.9},children:t.subtitle}),t.cta_text&&e.jsx(w,{variant:"accent",children:t.cta_text})]})})]}):e.jsxs(Ie,{defaultValue:"content",className:"space-y-6",children:[e.jsxs(Te,{className:"grid w-full grid-cols-3",children:[e.jsx(V,{value:"content",children:"Content"}),e.jsx(V,{value:"media",children:"Media"}),e.jsx(V,{value:"storage",children:"Storage"})]}),e.jsxs(W,{value:"content",className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(P,{children:e.jsx(L,{children:"Content"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"title",children:"Title"}),e.jsx(E,{id:"title",value:t.title,onChange:n=>u(i=>i?{...i,title:n.target.value}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"subtitle",children:"Subtitle (optional)"}),e.jsx(ie,{id:"subtitle",value:t.subtitle||"",onChange:n=>u(i=>i?{...i,subtitle:n.target.value||null}:null),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"cta-text",children:"CTA Button Text"}),e.jsx(E,{id:"cta-text",value:t.cta_text||"",onChange:n=>u(i=>i?{...i,cta_text:n.target.value||null}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"cta-link",children:"CTA Link (e.g., #contact)"}),e.jsx(E,{id:"cta-link",value:t.cta_link||"",onChange:n=>u(i=>i?{...i,cta_link:n.target.value||null}:null)})]})]})]})]}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ve,{className:"h-5 w-5 mr-2"}),"Styling & Page Theme"]})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"text-color",children:"Text Color"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"text-color",type:"color",value:t.text_color,onChange:n=>u(i=>i?{...i,text_color:n.target.value}:null),className:"w-16 h-10"}),e.jsx(E,{value:t.text_color,onChange:n=>u(i=>i?{...i,text_color:n.target.value}:null),placeholder:"#ffffff"})]})]}),e.jsxs("div",{children:[e.jsxs(_,{htmlFor:"overlay-opacity",children:["Overlay Opacity: ",(t.overlay_opacity*100).toFixed(0),"%"]}),e.jsx(E,{id:"overlay-opacity",type:"range",min:"0",max:"1",step:"0.05",value:t.overlay_opacity,onChange:n=>u(i=>i?{...i,overlay_opacity:parseFloat(n.target.value)}:null),className:"mt-2"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(_,{children:"Page Theme Override"}),e.jsxs("select",{className:"mt-2 px-3 py-2 border rounded w-full",value:T,onChange:n=>U(n.target.value),children:[e.jsx("option",{value:"inherit",children:"Inherit (default)"}),e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies to this page only. Does not affect user’s manual choice."})]})})]})]})]}),e.jsxs(W,{value:"media",className:"space-y-6",children:[t.media_url&&e.jsxs(k,{children:[e.jsx(P,{children:e.jsx(L,{children:"Current Media"})}),e.jsx(D,{children:e.jsx("div",{className:"relative w-full h-48 rounded-lg overflow-hidden bg-muted",children:t.media_type==="video"?e.jsx(mt,{src:t.media_url,className:"w-full h-full",autoPlay:!1,muted:!0,loop:!1,controls:!0,lazyLoad:!1}):e.jsx("img",{src:t.media_url,alt:"Current background",className:"w-full h-full object-cover"})})})]}),e.jsx(Ze,{onFileSelect:h,uploadProgress:j,isUploading:g,maxSizeMB:50})]}),e.jsx(W,{value:"storage",className:"space-y-6",children:e.jsx(Ss,{bucketName:"hero-media",onFileSelect:n=>{var l,N;const{data:{publicUrl:i}}=f.storage.from("hero-media").getPublicUrl(n.name),s=((N=(l=n.metadata)==null?void 0:l.mimetype)==null?void 0:N.startsWith("video/"))||/\.(mp4|webm|mov)(\?|$)/i.test(n.name);u(C=>C?{...C,media_type:s?"video":"image",media_url:i}:null),R({title:"Media selected",description:"Media has been applied to the banner"})}})})]})]})]})},oe=o.forwardRef(({className:a,...c},t)=>e.jsx(ht,{className:M("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",a),...c,ref:t,children:e.jsx(Zt,{className:M("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));oe.displayName=ht.displayName;var Dt="AlertDialog",[ks,oa]=es(Dt,[gt]),re=gt(),At=a=>{const{__scopeAlertDialog:c,...t}=a,u=re(c);return e.jsx(vt,{...u,...t,modal:!0})};At.displayName=Dt;var Fs="AlertDialogTrigger",Et=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,...u}=a,b=re(t);return e.jsx(pt,{...b,...u,ref:c})});Et.displayName=Fs;var Ds="AlertDialogPortal",It=a=>{const{__scopeAlertDialog:c,...t}=a,u=re(c);return e.jsx(ft,{...u,...t})};It.displayName=Ds;var As="AlertDialogOverlay",Tt=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,...u}=a,b=re(t);return e.jsx(He,{...b,...u,ref:c})});Tt.displayName=As;var me="AlertDialogContent",[Es,Is]=ks(me),Ts=as("AlertDialogContent"),Ot=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,children:u,...b}=a,F=re(t),A=o.useRef(null),I=jt(c,A),g=o.useRef(null);return e.jsx(ts,{contentName:me,titleName:Pt,docsSlug:"alert-dialog",children:e.jsx(Es,{scope:t,cancelRef:g,children:e.jsxs(Je,{role:"alertdialog",...F,...b,ref:I,onOpenAutoFocus:ss(b.onOpenAutoFocus,y=>{var j;y.preventDefault(),(j=g.current)==null||j.focus({preventScroll:!0})}),onPointerDownOutside:y=>y.preventDefault(),onInteractOutside:y=>y.preventDefault(),children:[e.jsx(Ts,{children:u}),e.jsx(Ps,{contentRef:A})]})})})});Ot.displayName=me;var Pt="AlertDialogTitle",Lt=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,...u}=a,b=re(t);return e.jsx(Ve,{...b,...u,ref:c})});Lt.displayName=Pt;var zt="AlertDialogDescription",Rt=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,...u}=a,b=re(t);return e.jsx(We,{...b,...u,ref:c})});Rt.displayName=zt;var Os="AlertDialogAction",Mt=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,...u}=a,b=re(t);return e.jsx(Ge,{...b,...u,ref:c})});Mt.displayName=Os;var qt="AlertDialogCancel",Ut=o.forwardRef((a,c)=>{const{__scopeAlertDialog:t,...u}=a,{cancelRef:b}=Is(qt,t),F=re(t),A=jt(c,b);return e.jsx(Ge,{...F,...u,ref:A})});Ut.displayName=qt;var Ps=({contentRef:a})=>{const c=`\`${me}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${me}\` by passing a \`${zt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${me}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return o.useEffect(()=>{var u;document.getElementById((u=a.current)==null?void 0:u.getAttribute("aria-describedby"))||console.warn(c)},[c,a]),null},Ls=At,zs=Et,Rs=It,$t=Tt,Bt=Ot,Ht=Mt,Jt=Ut,Vt=Lt,Wt=Rt;const we=Ls,be=zs,Ms=Rs,Gt=o.forwardRef(({className:a,...c},t)=>e.jsx($t,{className:M("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...c,ref:t}));Gt.displayName=$t.displayName;const ue=o.forwardRef(({className:a,...c},t)=>e.jsxs(Ms,{children:[e.jsx(Gt,{}),e.jsx(Bt,{ref:t,className:M("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c})]}));ue.displayName=Bt.displayName;const xe=({className:a,...c})=>e.jsx("div",{className:M("flex flex-col space-y-2 text-center sm:text-left",a),...c});xe.displayName="AlertDialogHeader";const he=({className:a,...c})=>e.jsx("div",{className:M("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...c});he.displayName="AlertDialogFooter";const ge=o.forwardRef(({className:a,...c},t)=>e.jsx(Vt,{ref:t,className:M("text-lg font-semibold",a),...c}));ge.displayName=Vt.displayName;const pe=o.forwardRef(({className:a,...c},t)=>e.jsx(Wt,{ref:t,className:M("text-sm text-muted-foreground",a),...c}));pe.displayName=Wt.displayName;const je=o.forwardRef(({className:a,...c},t)=>e.jsx(Ht,{ref:t,className:M(_t(),a),...c}));je.displayName=Ht.displayName;const fe=o.forwardRef(({className:a,...c},t)=>e.jsx(Jt,{ref:t,className:M(_t({variant:"outline"}),"mt-2 sm:mt-0",a),...c}));fe.displayName=Jt.displayName;const qs=()=>{const[a,c]=o.useState([]),[t,u]=o.useState([]),[b,F]=o.useState("home"),[A,I]=o.useState(!0),[g,y]=o.useState(!1),[j,x]=o.useState(null);o.useState(null);const{toast:v}=ne(),z=[{value:"home",label:"Home Page"},{value:"about",label:"About Page"},{value:"services",label:"Services Page"},{value:"careers",label:"Careers Page"},{value:"contact",label:"Contact Page"}];o.useEffect(()=>{T(),U()},[b]);const T=async()=>{try{I(!0);const{data:s,error:l}=await f.from("page_content").select("*").eq("page_name",b).order("order_index");if(l)throw l;c(s||[])}catch(s){console.error("Error fetching page content:",s),v({title:"Error",description:"Failed to load page content",variant:"destructive"})}finally{I(!1)}},U=async()=>{try{const{data:s,error:l}=await f.from("page_images").select("*").eq("page_name",b).order("order_index");if(l)throw l;u(s||[])}catch(s){console.error("Error fetching page images:",s)}},R=async s=>{try{if(y(!0),s.id){const{id:l,...N}=s,{error:C}=await f.from("page_content").update(N).eq("id",s.id);if(C)throw C}else{const{error:l}=await f.from("page_content").insert({page_name:b,section_name:s.section_name||"default",title:s.title,subtitle:s.subtitle,content:s.content,image_url:s.image_url,image_alt:s.image_alt,button_text:s.button_text,button_link:s.button_link,order_index:a.length,is_active:s.is_active!==void 0?s.is_active:!0});if(l)throw l}v({title:"Success",description:"Content saved successfully"}),T(),x(null)}catch(l){console.error("Error saving content:",l),v({title:"Error",description:"Failed to save content",variant:"destructive"})}finally{y(!1)}},p=async s=>{try{const{error:l}=await f.from("page_content").delete().eq("id",s);if(l)throw l;v({title:"Success",description:"Content deleted successfully"}),T()}catch(l){console.error("Error deleting content:",l),v({title:"Error",description:"Failed to delete content",variant:"destructive"})}},m=async(s,l)=>{try{const N=s.name.split(".").pop(),C=`${b}-${Date.now()}.${N}`,{data:q,error:J}=await f.storage.from("page-media").upload(C,s);if(J)throw J;const{data:{publicUrl:ee}}=f.storage.from("page-media").getPublicUrl(C),{error:Q}=await f.from("page_images").insert({page_name:b,section_name:l.section_name||"gallery",image_url:ee,image_alt:l.image_alt,image_caption:l.image_caption,image_type:l.image_type||"content",order_index:t.length,is_active:l.is_active!==void 0?l.is_active:!0});if(Q)throw Q;v({title:"Success",description:"Image uploaded successfully"}),U()}catch(N){console.error("Error uploading image:",N),v({title:"Error",description:"Failed to upload image",variant:"destructive"})}},h=(s,l)=>{const N=`/object/public/${l}/`,C=s.indexOf(N);return C!==-1?s.substring(C+N.length):s},n=async s=>{try{if(s.image_url){const l=h(s.image_url,"page-media");await f.storage.from("page-media").remove([l])}}catch(l){console.warn("Failed to remove storage object for image:",s.id,l)}finally{await f.from("page_images").delete().eq("id",s.id),U()}},i=async(s,l)=>{const N=a.findIndex(q=>q.id===s);if(N===-1)return;const C=l==="up"?N-1:N+1;if(!(C<0||C>=a.length))try{const q=a[N],J=a[C];await Promise.all([f.from("page_content").update({order_index:J.order_index}).eq("id",q.id),f.from("page_content").update({order_index:q.order_index}).eq("id",J.id)]),T()}catch(q){console.error("Error updating order:",q)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(qe,{className:"h-5 w-5 mr-2"}),"Content Management"]})}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(_,{htmlFor:"page-select",children:"Select Page:"}),e.jsxs(Le,{value:b,onValueChange:F,children:[e.jsx(ze,{className:"w-48",children:e.jsx(Re,{})}),e.jsx(Me,{children:z.map(s=>e.jsx(ke,{value:s.value,children:s.label},s.value))})]})]})})]}),e.jsxs(Ie,{defaultValue:"content",className:"space-y-6",children:[e.jsxs(Te,{className:"grid w-full grid-cols-2",children:[e.jsx(V,{value:"content",children:"Page Content"}),e.jsx(V,{value:"images",children:"Page Images"})]}),e.jsxs(W,{value:"content",className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Content Sections"}),e.jsxs(w,{onClick:()=>x({id:"",page_name:b,section_name:"",title:"",subtitle:"",content:"",image_url:null,image_alt:null,button_text:null,button_link:null,order_index:a.length,is_active:!0}),size:"sm",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Add Section"]})]})}),e.jsx(D,{children:A?e.jsx("div",{className:"text-center py-8",children:"Loading content..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No content sections found for this page"}):e.jsx("div",{className:"space-y-4",children:a.map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(X,{variant:s.is_active?"default":"secondary",children:s.section_name}),!s.is_active&&e.jsxs(X,{variant:"outline",children:[e.jsx(wt,{className:"h-3 w-3 mr-1"}),"Hidden"]})]}),e.jsx("h4",{className:"font-medium mt-2 truncate",children:s.title||"Untitled Section"}),s.subtitle&&e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.subtitle})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>i(s.id,"up"),disabled:l===0,children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>i(s.id,"down"),disabled:l===a.length-1,children:e.jsx(Ke,{className:"h-4 w-4"})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>x(s),children:"Edit"}),e.jsxs(we,{children:[e.jsx(be,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsxs(ue,{children:[e.jsxs(xe,{children:[e.jsx(ge,{children:"Delete this section?"}),e.jsx(pe,{children:"This action cannot be undone."})]}),e.jsxs(he,{children:[e.jsx(fe,{children:"Cancel"}),e.jsx(je,{onClick:()=>p(s.id),children:"Delete"})]})]})]})]})]},s.id))})})]}),j&&e.jsxs(k,{children:[e.jsx(P,{children:e.jsx(L,{children:j.id?"Edit Content Section":"Add Content Section"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"section-name",children:"Section Name"}),e.jsx(E,{id:"section-name",value:j.section_name,onChange:s=>x(l=>l?{...l,section_name:s.target.value}:null),placeholder:"e.g., hero, about, features"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{checked:j.is_active,onCheckedChange:s=>x(l=>l?{...l,is_active:s}:null)}),e.jsx(_,{children:"Active"})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"title",children:"Title"}),e.jsx(E,{id:"title",value:j.title||"",onChange:s=>x(l=>l?{...l,title:s.target.value}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"subtitle",children:"Subtitle"}),e.jsx(E,{id:"subtitle",value:j.subtitle||"",onChange:s=>x(l=>l?{...l,subtitle:s.target.value}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"content",children:"Content"}),e.jsx(ie,{id:"content",value:j.content||"",onChange:s=>x(l=>l?{...l,content:s.target.value}:null),rows:5})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"button-text",children:"Button Text"}),e.jsx(E,{id:"button-text",value:j.button_text||"",onChange:s=>x(l=>l?{...l,button_text:s.target.value}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"button-link",children:"Button Link"}),e.jsx(E,{id:"button-link",value:j.button_link||"",onChange:s=>x(l=>l?{...l,button_link:s.target.value}:null),placeholder:"e.g., #contact, /about"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(w,{variant:"outline",onClick:()=>x(null),children:"Cancel"}),e.jsxs(w,{onClick:()=>R(j),disabled:g,children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),g?"Saving...":"Save"]})]})]})]})]}),e.jsxs(W,{value:"images",className:"space-y-6",children:[e.jsx(Ze,{onFileSelect:s=>m(s,{section_name:"gallery",image_alt:s.name,image_caption:"",image_type:"content",is_active:!0}),maxSizeMB:20}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ye,{className:"h-5 w-5 mr-2"}),"Page Images"]})}),e.jsx(D,{children:t.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No images found for this page"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(s=>e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"aspect-video relative",children:[/\.(mp4|webm|mov)(\?|$)/i.test(s.image_url)?e.jsx("video",{src:s.image_url,className:"w-full h-full object-cover",controls:!0,muted:!0,playsInline:!0}):e.jsx("img",{src:s.image_url,alt:s.image_alt||"",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(X,{variant:s.is_active?"default":"secondary",children:s.image_type})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h5",{className:"font-medium text-sm",children:s.section_name}),s.image_caption&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.image_caption}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsxs(we,{children:[e.jsx(be,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:e.jsx(le,{className:"h-3 w-3"})})}),e.jsxs(ue,{children:[e.jsxs(xe,{children:[e.jsx(ge,{children:"Delete this image?"}),e.jsx(pe,{children:"This will permanently remove the image and its storage object."})]}),e.jsxs(he,{children:[e.jsx(fe,{children:"Cancel"}),e.jsx(je,{onClick:()=>n(s),children:"Delete"})]})]})]})})]})]},s.id))})})]})]})]})]})},Us=()=>{const[a,c]=o.useState([]),[t,u]=o.useState("company_info"),[b,F]=o.useState(!0),[A,I]=o.useState(!1),[g,y]=o.useState(null),{toast:j}=ne(),x=[{value:"company_info",label:"Company Information"},{value:"contact_info",label:"Contact Information"},{value:"social_links",label:"Social Links"},{value:"quick_links",label:"Quick Links"},{value:"services",label:"Services"},{value:"legal",label:"Legal Information"}],v=[{value:"mail",label:"Email",component:De},{value:"phone",label:"Phone",component:Qe},{value:"map-pin",label:"Location",component:bt},{value:"linkedin",label:"LinkedIn",component:ms},{value:"twitter",label:"Twitter",component:us},{value:"youtube",label:"YouTube",component:xs},{value:"globe",label:"Website",component:ae}];o.useEffect(()=>{z()},[t]);const z=async()=>{try{F(!0);const{data:m,error:h}=await f.from("footer_content").select("*").eq("section_type",t).order("order_index");if(h)throw h;c(m||[])}catch(m){console.error("Error fetching footer content:",m),j({title:"Error",description:"Failed to load footer content",variant:"destructive"})}finally{F(!1)}},T=async m=>{try{if(I(!0),m.id){const{id:h,...n}=m,{error:i}=await f.from("footer_content").update(n).eq("id",m.id);if(i)throw i}else{const{title:h,content:n,link_url:i,link_text:s,icon_name:l,is_active:N}=m,C={section_type:t,order_index:a.length,title:h??null,content:n??null,link_url:i??null,link_text:s??null,icon_name:l??null,is_active:N??!0},{error:q}=await f.from("footer_content").insert(C);if(q)throw q}j({title:"Success",description:"Footer content saved successfully"}),z(),y(null)}catch(h){console.error("Error saving footer content:",h),j({title:"Error",description:"Failed to save footer content",variant:"destructive"})}finally{I(!1)}},U=async m=>{try{const{error:h}=await f.from("footer_content").delete().eq("id",m);if(h)throw h;j({title:"Success",description:"Footer item deleted successfully"}),z()}catch(h){console.error("Error deleting footer item:",h),j({title:"Error",description:"Failed to delete footer item",variant:"destructive"})}},R=async(m,h)=>{const n=a.findIndex(s=>s.id===m);if(n===-1)return;const i=h==="up"?n-1:n+1;if(!(i<0||i>=a.length))try{const s=a[n],l=a[i];await Promise.all([f.from("footer_content").update({order_index:l.order_index}).eq("id",s.id),f.from("footer_content").update({order_index:s.order_index}).eq("id",l.id)]),z()}catch(s){console.error("Error updating order:",s)}},p=m=>{const h=v.find(n=>n.value===m);if(h){const n=h.component;return e.jsx(n,{className:"h-4 w-4"})}return null};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Footer Management"]})}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(_,{htmlFor:"section-select",children:"Select Section:"}),e.jsxs(Le,{value:t,onValueChange:u,children:[e.jsx(ze,{className:"w-64",children:e.jsx(Re,{})}),e.jsx(Me,{children:x.map(m=>e.jsx(ke,{value:m.value,children:m.label},m.value))})]})]})})]}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Footer Items"}),e.jsxs(w,{onClick:()=>y({id:"",section_type:t,title:"",content:"",link_url:null,link_text:null,icon_name:null,order_index:a.length,is_active:!0}),size:"sm",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Add Item"]})]})}),e.jsx(D,{children:b?e.jsx("div",{className:"text-center py-8",children:"Loading footer content..."}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No items found for this section"}):e.jsx("div",{className:"space-y-4",children:a.map((m,h)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[p(m.icon_name),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium",children:m.title||m.content||"Untitled Item"}),!m.is_active&&e.jsx(X,{variant:"outline",children:"Hidden"})]}),m.link_url&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["→ ",m.link_url]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>R(m.id,"up"),disabled:h===0,children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>R(m.id,"down"),disabled:h===a.length-1,children:e.jsx(Ke,{className:"h-4 w-4"})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>y(m),children:"Edit"}),e.jsxs(we,{children:[e.jsx(be,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsxs(ue,{children:[e.jsxs(xe,{children:[e.jsx(ge,{children:"Delete this footer item?"}),e.jsx(pe,{children:"This action cannot be undone."})]}),e.jsxs(he,{children:[e.jsx(fe,{children:"Cancel"}),e.jsx(je,{onClick:()=>U(m.id),children:"Delete"})]})]})]})]})]},m.id))})})]}),g&&e.jsxs(k,{children:[e.jsx(P,{children:e.jsx(L,{children:g.id?"Edit Footer Item":"Add Footer Item"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"title",children:"Title"}),e.jsx(E,{id:"title",value:g.title||"",onChange:m=>y(h=>h?{...h,title:m.target.value}:null)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{checked:g.is_active,onCheckedChange:m=>y(h=>h?{...h,is_active:m}:null)}),e.jsx(_,{children:"Active"})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"content",children:"Content"}),e.jsx(ie,{id:"content",value:g.content||"",onChange:m=>y(h=>h?{...h,content:m.target.value}:null),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"link-text",children:"Link Text"}),e.jsx(E,{id:"link-text",value:g.link_text||"",onChange:m=>y(h=>h?{...h,link_text:m.target.value}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"link-url",children:"Link URL"}),e.jsx(E,{id:"link-url",value:g.link_url||"",onChange:m=>y(h=>h?{...h,link_url:m.target.value}:null),placeholder:"e.g., #contact, https://example.com"})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"icon-select",children:"Icon"}),e.jsxs(Le,{value:g.icon_name&&g.icon_name!==""?g.icon_name:"none",onValueChange:m=>y(h=>h?{...h,icon_name:m==="none"?null:m}:null),children:[e.jsx(ze,{children:e.jsx(Re,{placeholder:"Select an icon"})}),e.jsxs(Me,{children:[e.jsx(ke,{value:"none",children:"No icon"}),v.map(m=>e.jsx(ke,{value:m.value,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[is.createElement(m.component,{className:"h-4 w-4"}),e.jsx("span",{children:m.label})]})},m.value))]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(w,{variant:"outline",onClick:()=>y(null),children:"Cancel"}),e.jsxs(w,{onClick:()=>T(g),disabled:A,children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),A?"Saving...":"Save"]})]})]})]})]})},$s=()=>{var l,N,C,q,J,ee,Q,G,te,de,Se;const[a,c]=o.useState({}),[t,u]=o.useState(!0),[b,F]=o.useState(!1),[A,I]=o.useState(new Set),[g,y]=o.useState(!1),{toast:j}=ne();o.useEffect(()=>{x()},[]);const x=async()=>{try{u(!0);const{data:d,error:r}=await f.from("site_settings").select("*");if(r)throw r;const S=(d||[]).reduce(($,B)=>($[B.setting_key]=B,$),{});c(S);const O={};Object.values(S).forEach($=>{$.setting_value!=null&&(O[$.setting_key]=$.setting_value)}),ct(O)}catch(d){console.error("Error fetching settings:",d),j({title:"Error",description:"Failed to load site settings",variant:"destructive"})}finally{u(!1)}},v=async(d,r)=>{const S=a[d],$=!!S?{...S,setting_value:r}:{id:d,setting_key:d,setting_value:r,setting_type:"text",description:d.replace(/_/g," ")};c(B=>({...B,[d]:$}));try{const{error:B}=await f.from("site_settings").upsert({setting_key:d,setting_value:r,setting_type:"text",description:d.replace(/_/g," ")},{onConflict:"setting_key"});if(B)throw B;const H={};Object.entries(a).forEach(([se,Z])=>{(Z==null?void 0:Z.setting_value)!=null&&(H[se]=Z.setting_value)}),r!=null&&(H[d]=r),ct(H),I(se=>{const Z=new Set(se);return Z.delete(d),Z})}catch(B){console.error("Error updating setting:",B),c(H=>({...H,...S?{[d]:S}:(()=>{const{[d]:se,...Z}=H;return Z})()})),I(H=>new Set(H).add(d)),j({title:"Error",description:"Failed to update setting on server. Please check Supabase policies.",variant:"destructive"})}},z=async()=>{try{F(!0),j({title:"Success",description:"Settings saved successfully"})}catch{j({title:"Error",description:"Failed to save settings",variant:"destructive"})}finally{F(!1)}},T=async d=>{try{y(!0);const r=d.name.split(".").pop(),S=`logo-${Date.now()}.${r}`,{data:O,error:$}=await f.storage.from("hero-media").upload(S,d);if($)throw $;const{data:{publicUrl:B}}=f.storage.from("hero-media").getPublicUrl(S);await v("logo_url",B),j({title:"Success",description:"Logo uploaded successfully"}),x()}catch(r){console.error("Error uploading logo:",r),j({title:"Error",description:"Failed to upload logo",variant:"destructive"})}finally{y(!1)}},U=async()=>{try{await v("logo_url",null),j({title:"Success",description:"Logo removed successfully"}),x()}catch{j({title:"Error",description:"Failed to remove logo",variant:"destructive"})}},R=async()=>{const d=r=>{var S;return((S=a[r])==null?void 0:S.setting_value)||""};try{const r=[];(d("company_name")||d("company_tagline"))&&r.push({section_type:"company_info",title:d("company_name")||"Company",content:d("company_tagline")||null,link_url:null,link_text:null,icon_name:null,order_index:0,is_active:!0});const S=d("primary_email"),O=d("primary_phone"),$=d("address");let B=0;S&&r.push({section_type:"contact_info",title:"Email",content:S,link_url:`mailto:${S}`,link_text:S,icon_name:"mail",order_index:B++,is_active:!0}),O&&r.push({section_type:"contact_info",title:"Phone",content:O,link_url:`tel:${O}`,link_text:O,icon_name:"phone",order_index:B++,is_active:!0}),$&&r.push({section_type:"contact_info",title:"Address",content:$,link_url:null,link_text:null,icon_name:"map-pin",order_index:B++,is_active:!0});const H=d("linkedin_url"),se=d("twitter_url"),Z=d("youtube_url");let Oe=0;H&&r.push({section_type:"social_links",title:"LinkedIn",content:null,link_url:H,link_text:"LinkedIn",icon_name:"linkedin",order_index:Oe++,is_active:!0}),se&&r.push({section_type:"social_links",title:"Twitter",content:null,link_url:se,link_text:"Twitter",icon_name:"twitter",order_index:Oe++,is_active:!0}),Z&&r.push({section_type:"social_links",title:"YouTube",content:null,link_url:Z,link_text:"YouTube",icon_name:"youtube",order_index:Oe++,is_active:!0});const at=d("footer_copyright_text")||`© ${new Date().getFullYear()} ${d("company_name")}`,it=d("footer_certifications_text"),nt=d("footer_privacy_url"),rt=d("footer_terms_url");let Ce=0;at&&r.push({section_type:"legal",title:"Copyright",content:at,link_url:null,link_text:null,icon_name:null,order_index:Ce++,is_active:!0}),it&&r.push({section_type:"legal",title:"Certifications",content:it,link_url:null,link_text:null,icon_name:null,order_index:Ce++,is_active:!0}),nt&&r.push({section_type:"legal",title:"Privacy Policy",content:"#",link_url:nt,link_text:"Privacy Policy",icon_name:null,order_index:Ce++,is_active:!0}),rt&&r.push({section_type:"legal",title:"Terms of Service",content:"#",link_url:rt,link_text:"Terms of Service",icon_name:null,order_index:Ce++,is_active:!0});const{error:lt}=await f.from("footer_content").delete().in("section_type",["company_info","contact_info","social_links","legal"]);if(lt)throw lt;if(r.length>0){const{error:ot}=await f.from("footer_content").insert(r);if(ot)throw ot}j({title:"Footer updated",description:"Footer content synced from Site Settings."})}catch(r){console.error("Error syncing footer:",r),j({title:"Error",description:"Failed to update footer content",variant:"destructive"})}},p=(d,r)=>{const S=r.setting_value||"";switch(r.setting_type){case"boolean":return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{checked:S==="true",onCheckedChange:O=>v(d,O?"true":"false")}),e.jsx(_,{children:r.description})]});case"image":return d==="logo_url"?e.jsxs("div",{className:"space-y-4",children:[S&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:S,alt:"Current logo",className:"h-16 w-auto border rounded-lg"})}),e.jsxs(w,{variant:"ghost",size:"sm",onClick:U,className:"text-destructive hover:text-destructive",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Remove Logo"]})]}),e.jsx(Ze,{onFileSelect:T,isUploading:g,maxSizeMB:5})]}):e.jsx(E,{value:S,onChange:O=>v(d,O.target.value),placeholder:"Enter image URL"});default:return r.description&&r.description.includes("description")?e.jsx(ie,{value:S,onChange:O=>v(d,O.target.value),rows:3}):e.jsx(E,{value:S,onChange:O=>v(d,O.target.value)})}};if(t)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"text-center py-8",children:"Loading site settings..."})});const m=["company_name","company_tagline","logo_url"],h=["primary_email","primary_phone","address"],n=["facebook_url","linkedin_url","twitter_url","youtube_url"],i=["cta_button_text","enable_floating_cta"],s=["meta_description","meta_keywords","google_analytics_id"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Ie,{defaultValue:"company",className:"space-y-6",children:[e.jsxs(Te,{className:"grid w-full grid-cols-7",children:[e.jsxs(V,{value:"company",className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Company"})]}),e.jsxs(V,{value:"contact",className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Contact"})]}),e.jsxs(V,{value:"social",className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Social"})]}),e.jsxs(V,{value:"footer",className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Footer"})]}),e.jsxs(V,{value:"general",className:"flex items-center space-x-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{children:"General"})]}),e.jsxs(V,{value:"seo",className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:"SEO"})]}),e.jsxs(V,{value:"appearance",className:"flex items-center space-x-2",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:"Appearance"})]})]}),e.jsx(W,{value:"company",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ae,{className:"h-5 w-5 mr-2"}),"Company Information"]})}),e.jsx(D,{className:"space-y-6",children:m.map(d=>{const r=a[d];return r?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"text-sm font-medium",children:r.description}),p(d,r)]},d):null})})]})}),e.jsx(W,{value:"contact",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(De,{className:"h-5 w-5 mr-2"}),"Contact Information"]})}),e.jsx(D,{className:"space-y-6",children:h.map(d=>{const r=a[d];return r?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"text-sm font-medium",children:r.description}),p(d,r)]},d):null})})]})}),e.jsx(W,{value:"social",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Social Media Links"]})}),e.jsx(D,{className:"space-y-6",children:n.map(d=>{const r=a[d];return r?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"text-sm font-medium",children:r.description}),p(d,r)]},d):null})})]})}),e.jsx(W,{value:"footer",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Footer Settings"]})}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Copyright Text"}),e.jsx(ie,{value:((l=a.footer_copyright_text)==null?void 0:l.setting_value)||"",onChange:d=>v("footer_copyright_text",d.target.value),rows:3,placeholder:`© ${new Date().getFullYear()} ${((N=a.company_name)==null?void 0:N.setting_value)||"Your Company"}`})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Certifications Text"}),e.jsx(ie,{value:((C=a.footer_certifications_text)==null?void 0:C.setting_value)||"",onChange:d=>v("footer_certifications_text",d.target.value),rows:3,placeholder:"ISO 27001 | SOC 2 | Oracle Partner"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Privacy Policy URL"}),e.jsx(E,{value:((q=a.footer_privacy_url)==null?void 0:q.setting_value)||"",onChange:d=>v("footer_privacy_url",d.target.value),placeholder:"/privacy-policy or https://..."})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Terms of Service URL"}),e.jsx(E,{value:((J=a.footer_terms_url)==null?void 0:J.setting_value)||"",onChange:d=>v("footer_terms_url",d.target.value),placeholder:"/terms or https://..."})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs(w,{onClick:R,size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Update Footer Content"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"This will overwrite Company, Contact, Social and Legal sections in footer to match settings above."})]})]})]})}),e.jsx(W,{value:"general",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ee,{className:"h-5 w-5 mr-2"}),"General Settings"]})}),e.jsx(D,{className:"space-y-6",children:i.map(d=>{const r=a[d];return r?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"text-sm font-medium",children:r.description}),p(d,r)]},d):null})})]})}),e.jsx(W,{value:"seo",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ve,{className:"h-5 w-5 mr-2"}),"SEO & Analytics"]})}),e.jsx(D,{className:"space-y-6",children:s.map(d=>{const r=a[d];return r?e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"text-sm font-medium",children:r.description}),p(d,r)]},d):null})})]})}),e.jsx(W,{value:"appearance",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ve,{className:"h-5 w-5 mr-2"}),"Theme & Hero Defaults"]})}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Default Theme"}),e.jsx("div",{className:"mt-2",children:e.jsxs("select",{className:"px-3 py-2 border rounded w-full",value:((ee=a.default_theme)==null?void 0:ee.setting_value)||"light",onChange:d=>v("default_theme",d.target.value),children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]})})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6 md:mt-0",children:[e.jsx(oe,{checked:(((Q=a.theme_follow_system)==null?void 0:Q.setting_value)||"false")==="true",onCheckedChange:d=>v("theme_follow_system",d?"true":"false")}),e.jsx(_,{children:"Follow system theme if user has no preference"}),A.has("theme_follow_system")&&e.jsx(w,{variant:"outline",size:"sm",onClick:()=>{var d;return v("theme_follow_system",((d=a.theme_follow_system)==null?void 0:d.setting_value)||"false")},children:"Retry"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Default Hero Overlay Opacity"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:parseFloat(((G=a.hero_default_overlay_opacity)==null?void 0:G.setting_value)||"0.7"),onChange:d=>v("hero_default_overlay_opacity",d.target.value),className:"w-full mt-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[(parseFloat(((te=a.hero_default_overlay_opacity)==null?void 0:te.setting_value)||"0.7")*100).toFixed(0),"%"]}),A.has("hero_default_overlay_opacity")&&e.jsx(w,{variant:"outline",size:"sm",onClick:()=>{var d;return v("hero_default_overlay_opacity",((d=a.hero_default_overlay_opacity)==null?void 0:d.setting_value)||"0.7")},children:"Retry"})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Default Hero Text Color"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(E,{type:"color",value:((de=a.hero_default_text_color)==null?void 0:de.setting_value)||"#ffffff",onChange:d=>v("hero_default_text_color",d.target.value),className:"w-20 h-10"}),e.jsx(E,{value:((Se=a.hero_default_text_color)==null?void 0:Se.setting_value)||"#ffffff",onChange:d=>v("hero_default_text_color",d.target.value)})]}),A.has("hero_default_text_color")&&e.jsx(w,{variant:"outline",size:"sm",onClick:()=>{var d;return v("hero_default_text_color",((d=a.hero_default_text_color)==null?void 0:d.setting_value)||"#ffffff")},children:"Retry"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pages can override these defaults in Hero Banner settings. Defaults are used when page-specific values are not set."})]})]})})]}),e.jsx(k,{children:e.jsx(D,{className:"pt-6",children:e.jsxs(w,{onClick:z,disabled:b,className:"w-full",size:"lg",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),b?"Saving...":"Save All Settings"]})})})]})},Yt=vt,Kt=pt,Bs=ft,Qt=o.forwardRef(({className:a,...c},t)=>e.jsx(He,{ref:t,className:M("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...c}));Qt.displayName=He.displayName;const et=o.forwardRef(({className:a,children:c,...t},u)=>e.jsxs(Bs,{children:[e.jsx(Qt,{}),e.jsxs(Je,{ref:u,className:M("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t,children:[c,e.jsxs(Ge,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(St,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));et.displayName=Je.displayName;const tt=({className:a,...c})=>e.jsx("div",{className:M("flex flex-col space-y-1.5 text-center sm:text-left",a),...c});tt.displayName="DialogHeader";const st=o.forwardRef(({className:a,...c},t)=>e.jsx(Ve,{ref:t,className:M("text-lg font-semibold leading-none tracking-tight",a),...c}));st.displayName=Ve.displayName;const Hs=o.forwardRef(({className:a,...c},t)=>e.jsx(We,{ref:t,className:M("text-sm text-muted-foreground",a),...c}));Hs.displayName=We.displayName;const Js=()=>{const[a,c]=o.useState([]),[t,u]=o.useState(null),[b,F]=o.useState(!1),[A,I]=o.useState(!0),[g,y]=o.useState(!1),{toast:j}=ne(),[x,v]=o.useState({title:"",department:"",location:"",type:"Full-time",experience:"",skills:"",description:"",requirements:"",is_urgent:!1,is_active:!0});o.useEffect(()=>{z()},[]);const z=async()=>{try{const{data:{session:n}}=await f.auth.getSession();if(!n){console.log("Not authenticated - showing demo data"),c(T()),I(!1);return}const{data:i,error:s}=await f.from("job_openings").select("*").order("created_at",{ascending:!1});s?(console.error("Database error:",s),c(T()),j({title:"Info",description:"Showing demo data - database access restricted",variant:"default"})):c(i||T())}catch(n){console.error("Error fetching job openings:",n),c(T()),j({title:"Info",description:"Showing demo data due to connection issue",variant:"default"})}finally{I(!1)}},T=()=>[{id:"1",title:"Senior Oracle Fusion Developer",department:"Engineering",location:"Remote / Hybrid",type:"Full-time",experience:"5+ years",skills:["Oracle Fusion","PL/SQL","Java","REST APIs","OIC"],description:"Lead Oracle Fusion development projects and mentor junior developers in creating scalable enterprise solutions.",requirements:"Bachelor's degree in Computer Science or related field. 5+ years of Oracle Fusion development experience.",is_urgent:!0,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"2",title:"Oracle EBS Functional Consultant",department:"Consulting",location:"Onsite / Remote",type:"Full-time",experience:"3-5 years",skills:["Oracle EBS","Financials","Supply Chain","HRMS","Business Analysis"],description:"Work with clients to implement and optimize Oracle EBS modules for business process improvements.",requirements:"Experience with Oracle EBS R12, functional knowledge of Finance or SCM modules.",is_urgent:!1,is_active:!0,created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString()},{id:"3",title:"Cloud Integration Specialist",department:"Cloud Solutions",location:"Remote",type:"Contract",experience:"4+ years",skills:["OIC","Oracle Cloud","Integration","SOA","APIs"],description:"Design and implement cloud integration solutions using Oracle Integration Cloud and related technologies.",requirements:"Strong experience with Oracle Integration Cloud, REST/SOAP services, and cloud architectures.",is_urgent:!1,is_active:!1,created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-1728e5).toISOString()}],U=n=>{u(n),v({title:n.title,department:n.department,location:n.location,type:n.type,experience:n.experience,skills:n.skills.join(", "),description:n.description||"",requirements:n.requirements||"",is_urgent:n.is_urgent,is_active:n.is_active}),F(!0)},R=()=>{u(null),v({title:"",department:"",location:"",type:"Full-time",experience:"",skills:"",description:"",requirements:"",is_urgent:!1,is_active:!0}),F(!0)},p=async()=>{y(!0);try{const n=x.skills.split(",").map(s=>s.trim()).filter(s=>s.length>0),i={title:x.title,department:x.department,location:x.location,type:x.type,experience:x.experience,skills:n,description:x.description||null,requirements:x.requirements||null,is_urgent:x.is_urgent,is_active:x.is_active};if(t){const{error:s}=await f.from("job_openings").update(i).eq("id",t.id);if(s)throw s;j({title:"Success",description:"Job opening updated successfully"})}else{const{error:s}=await f.from("job_openings").insert([i]);if(s)throw s;j({title:"Success",description:"Job opening created successfully"})}F(!1),z()}catch(n){console.error("Error saving job opening:",n),j({title:"Error",description:"Failed to save job opening",variant:"destructive"})}finally{y(!1)}},m=async n=>{try{const{error:i}=await f.from("job_openings").delete().eq("id",n);if(i)throw i;j({title:"Success",description:"Job opening deleted successfully"}),z()}catch(i){console.error("Error deleting job opening:",i),j({title:"Error",description:"Failed to delete job opening",variant:"destructive"})}},h=(n,i)=>{v(s=>({...s,[n]:i}))};return A?e.jsx("div",{className:"p-6",children:"Loading job openings..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Job Openings Management"}),e.jsxs(Yt,{open:b,onOpenChange:F,children:[e.jsx(Kt,{asChild:!0,children:e.jsxs(w,{onClick:R,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Add Job Opening"]})}),e.jsxs(et,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(tt,{children:e.jsx(st,{children:t?"Edit Job Opening":"Add New Job Opening"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"title",children:"Job Title"}),e.jsx(E,{id:"title",value:x.title,onChange:n=>h("title",n.target.value),placeholder:"e.g., Senior Oracle Developer"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"department",children:"Department"}),e.jsx(E,{id:"department",value:x.department,onChange:n=>h("department",n.target.value),placeholder:"e.g., Technical"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"location",children:"Location"}),e.jsx(E,{id:"location",value:x.location,onChange:n=>h("location",n.target.value),placeholder:"e.g., Remote / Hyderabad"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"type",children:"Job Type"}),e.jsx(E,{id:"type",value:x.type,onChange:n=>h("type",n.target.value),placeholder:"e.g., Full-time"})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"experience",children:"Experience Required"}),e.jsx(E,{id:"experience",value:x.experience,onChange:n=>h("experience",n.target.value),placeholder:"e.g., 5+ years"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"skills",children:"Skills (comma-separated)"}),e.jsx(E,{id:"skills",value:x.skills,onChange:n=>h("skills",n.target.value),placeholder:"e.g., Oracle ERP, PL/SQL, JavaScript"})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"description",children:"Job Description"}),e.jsx(ie,{id:"description",value:x.description,onChange:n=>h("description",n.target.value),placeholder:"Describe the role and responsibilities...",rows:4})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"requirements",children:"Requirements"}),e.jsx(ie,{id:"requirements",value:x.requirements,onChange:n=>h("requirements",n.target.value),placeholder:"List the requirements and qualifications...",rows:4})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{id:"is_urgent",checked:x.is_urgent,onCheckedChange:n=>h("is_urgent",n)}),e.jsx(_,{htmlFor:"is_urgent",children:"Urgent Hiring"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{id:"is_active",checked:x.is_active,onCheckedChange:n=>h("is_active",n)}),e.jsx(_,{htmlFor:"is_active",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsxs(w,{variant:"outline",onClick:()=>F(!1),disabled:g,children:[e.jsx(St,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs(w,{onClick:p,disabled:g||!x.title.trim(),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),g?"Saving...":"Save"]})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4",children:[a.map(n=>e.jsxs(k,{className:"relative",children:[n.is_urgent&&e.jsx("div",{className:"absolute -top-2 left-4",children:e.jsxs(X,{className:"bg-red-500 text-white",children:[e.jsx(yt,{className:"h-3 w-3 mr-1"}),"Urgent"]})}),e.jsx(P,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:n.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:n.department})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(bt,{className:"h-4 w-4"}),e.jsx("span",{children:n.location})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(gs,{className:"h-4 w-4"}),e.jsxs("span",{children:[n.type," • ",n.experience]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{variant:n.is_active?"default":"secondary",children:n.is_active?"Active":"Inactive"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>U(n),children:e.jsx(Ct,{className:"h-4 w-4"})}),e.jsxs(we,{children:[e.jsx(be,{asChild:!0,children:e.jsx(w,{variant:"outline",size:"sm",children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsxs(ue,{children:[e.jsxs(xe,{children:[e.jsx(ge,{children:"Delete Job Opening"}),e.jsxs(pe,{children:['Are you sure you want to delete "',n.title,'"? This action cannot be undone.']})]}),e.jsxs(he,{children:[e.jsx(fe,{children:"Cancel"}),e.jsx(je,{onClick:()=>m(n.id),className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})]})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:n.skills.map((i,s)=>e.jsx(X,{variant:"secondary",className:"text-xs",children:i},s))}),n.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:n.description})]})})]},n.id)),a.length===0&&e.jsx(k,{children:e.jsxs(D,{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"No job openings found."}),e.jsxs(w,{className:"mt-4",onClick:R,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Add First Job Opening"]})]})})]})]})},Vs=()=>{const[a,c]=o.useState([]),[t,u]=o.useState(null),[b,F]=o.useState(!1),[A,I]=o.useState(!0),[g,y]=o.useState(!1),{toast:j}=ne();o.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:p,error:m}=await f.from("testimonials").select("*").order("order_index",{ascending:!0});if(m)throw m;c(p||[])}catch{console.log("Testimonials fetch failed; showing demo data"),c([{id:"d1",name:"Jane Cooper",role:"CIO",company:"TechCorp",content:"Vijay Apps transformed our Oracle stack with precision and speed.",avatar_url:null,rating:5,is_active:!0,order_index:0},{id:"d2",name:"Wade Warren",role:"VP Operations",company:"Global Industries",content:"Outstanding Fusion implementation with measurable ROI in months.",avatar_url:null,rating:5,is_active:!0,order_index:1}]),j({title:"Info",description:"DB access restricted. Showing demo testimonials."})}finally{I(!1)}},v=()=>{u({id:"",name:"",role:"",company:"",content:"",avatar_url:"",rating:5,is_active:!0,order_index:a.length}),F(!0)},z=p=>{u({...p}),F(!0)},T=async()=>{if(t){y(!0);try{const p={name:t.name,role:t.role||null,company:t.company||null,content:t.content,avatar_url:t.avatar_url||null,rating:t.rating??5,is_active:t.is_active,order_index:t.order_index};if(t.id){const{error:m}=await f.from("testimonials").update(p).eq("id",t.id);if(m)throw m;j({title:"Updated",description:"Testimonial updated successfully"})}else{const{error:m}=await f.from("testimonials").insert(p);if(m)throw m;j({title:"Created",description:"Testimonial added successfully"})}F(!1),x()}catch(p){console.error(p),j({title:"Error",description:"Failed to save testimonial",variant:"destructive"})}finally{y(!1)}}},U=async p=>{try{const{error:m}=await f.from("testimonials").delete().eq("id",p);if(m)throw m;j({title:"Deleted",description:"Testimonial removed"}),x()}catch(m){console.error(m),j({title:"Error",description:"Failed to delete testimonial",variant:"destructive"})}},R=async(p,m)=>{const h=a.findIndex(i=>i.id===p);if(h<0)return;const n=m==="up"?h-1:h+1;if(!(n<0||n>=a.length))try{const i=a[h],s=a[n];await Promise.all([f.from("testimonials").update({order_index:s.order_index}).eq("id",i.id),f.from("testimonials").update({order_index:i.order_index}).eq("id",s.id)]),x()}catch(i){console.error(i)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Testimonials Management"}),e.jsxs(Yt,{open:b,onOpenChange:F,children:[e.jsx(Kt,{asChild:!0,children:e.jsxs(w,{onClick:v,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"})," Add Testimonial"]})}),e.jsxs(et,{className:"max-w-2xl",children:[e.jsx(tt,{children:e.jsx(st,{children:t!=null&&t.id?"Edit Testimonial":"Add New Testimonial"})}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Name"}),e.jsx(E,{value:t.name,onChange:p=>u({...t,name:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(_,{children:"Company"}),e.jsx(E,{value:t.company||"",onChange:p=>u({...t,company:p.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Role / Title"}),e.jsx(E,{value:t.role||"",onChange:p=>u({...t,role:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(_,{children:"Avatar URL"}),e.jsx(E,{value:t.avatar_url||"",onChange:p=>u({...t,avatar_url:p.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(_,{children:"Testimonial"}),e.jsx(ie,{rows:4,value:t.content,onChange:p=>u({...t,content:p.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Rating (1-5)"}),e.jsx(E,{type:"number",min:1,max:5,value:t.rating??5,onChange:p=>u({...t,rating:Math.max(1,Math.min(5,Number(p.target.value)))})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[e.jsx(oe,{checked:t.is_active,onCheckedChange:p=>u({...t,is_active:p})}),e.jsx(_,{children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(w,{variant:"outline",onClick:()=>F(!1),children:"Cancel"}),e.jsxs(w,{onClick:T,disabled:g,children:[e.jsx(ce,{className:"h-4 w-4 mr-2"})," ",g?"Saving...":"Save"]})]})]})]})]})]}),A?e.jsx("div",{className:"p-6",children:"Loading testimonials..."}):e.jsx("div",{className:"space-y-4",children:a.map((p,m)=>e.jsxs(k,{children:[e.jsx(P,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-lg flex items-center gap-2",children:[p.name,p.rating?e.jsxs("span",{className:"inline-flex items-center text-yellow-500 text-sm",children:[e.jsx(ps,{className:"h-4 w-4 mr-1"})," ",p.rating]}):null]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:[p.role,p.company].filter(Boolean).join(" • ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>R(p.id,"up"),disabled:m===0,children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>R(p.id,"down"),disabled:m===a.length-1,children:e.jsx(Ke,{className:"h-4 w-4"})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>z(p),children:e.jsx(Ct,{className:"h-4 w-4"})}),e.jsxs(we,{children:[e.jsx(be,{asChild:!0,children:e.jsx(w,{variant:"outline",size:"sm",className:"text-destructive",children:e.jsx(le,{className:"h-4 w-4"})})}),e.jsxs(ue,{children:[e.jsxs(xe,{children:[e.jsx(ge,{children:"Delete testimonial?"}),e.jsx(pe,{children:"This action cannot be undone."})]}),e.jsxs(he,{children:[e.jsx(fe,{children:"Cancel"}),e.jsx(je,{onClick:()=>U(p.id),children:"Delete"})]})]})]})]})]})}),e.jsx(D,{children:e.jsx("p",{className:"text-sm text-foreground",children:p.content})})]},p.id))})]})},ca=()=>{const[a,c]=o.useState(!1),[t,u]=o.useState(""),[b,F]=o.useState(""),[A,I]=o.useState(!1),[g,y]=o.useState([]),[j,x]=o.useState(null),[v,z]=o.useState("all"),[T,U]=o.useState(""),[R,p]=o.useState(1),[m]=o.useState(10),[h,n]=o.useState([]),{toast:i}=ne();o.useEffect(()=>{l(),(async()=>{try{const{data:r}=await f.from("site_settings").select("setting_value").eq("setting_key","logo_url").single();r!=null&&r.setting_value&&x(r.setting_value)}catch{}})()},[]),o.useEffect(()=>{a&&(q(),d())},[a]);const s=async(r,S)=>{try{const{data:{user:O}}=await f.auth.getUser();if(O){const{error:$}=await f.from("admin_activity_logs").insert({user_id:O.id,user_email:O.email,action:r,resource:S,ip_address:"client-side",user_agent:navigator.userAgent});$&&console.log("Activity logging disabled due to RLS restrictions")}}catch(O){console.log("Activity logging failed:",O)}},l=async()=>{const{data:{session:r}}=await f.auth.getSession();r&&await s("admin_panel_access","dashboard"),c(!!r)},N=async r=>{r.preventDefault(),I(!0);try{const{error:S}=await f.auth.signInWithPassword({email:t,password:b});if(S)throw S;c(!0),await s("admin_login","authentication"),i({title:"Login Successful",description:"Welcome to the admin panel."})}catch(S){i({title:"Login Failed",description:S.message,variant:"destructive"})}finally{I(!1)}},C=async()=>{await s("admin_logout","authentication"),await f.auth.signOut(),c(!1),y([])},q=async()=>{try{await s("view_contact_submissions","contact_submissions");const{data:r,error:S}=await f.from("contact_submissions").select("*").order("created_at",{ascending:!1});if(S){console.error("Database error:",S),y(J()),i({title:"Info",description:"Showing demo contact submissions - database access restricted",variant:"default"});return}y(r||J())}catch(r){console.error("Error fetching submissions:",r),y(J()),i({title:"Info",description:"Showing demo data due to connection issue",variant:"default"})}},J=()=>[{id:"1",name:"John Smith",email:"john.smith@techcorp.com",company:"TechCorp Solutions",phone:"+1-555-0123",service_interest:"Oracle Fusion Implementation",message:"We need help implementing Oracle Fusion Cloud for our manufacturing operations. Looking for experienced consultants.",consultation_requested:!0,status:"new",created_at:new Date().toISOString()},{id:"2",name:"Sarah Johnson",email:"sarah.j@globalltd.com",company:"Global Industries Ltd",phone:"+1-555-0456",service_interest:"Oracle EBS Support",message:"Current EBS system needs optimization and support. Interested in your maintenance services.",consultation_requested:!1,status:"contacted",created_at:new Date(Date.now()-864e5).toISOString()},{id:"3",name:"Mike Chen",email:"mike.chen@startup.io",company:"StartupTech",phone:null,service_interest:"Cloud Migration",message:"Looking to migrate our on-premise Oracle systems to cloud. Need consultation on best practices.",consultation_requested:!0,status:"closed",created_at:new Date(Date.now()-1728e5).toISOString()}],ee=async(r,S)=>{try{const{error:O}=await f.from("contact_submissions").update({status:S}).eq("id",r);if(O)throw O;await s("status_update",`contact_submission:${r}`),y($=>$.map(B=>B.id===r?{...B,status:S}:B)),i({title:"Status Updated",description:"Submission status has been updated."})}catch{i({title:"Error",description:"Failed to update status.",variant:"destructive"})}},Q=g.filter(r=>{const S=v==="all"||r.status===v,$=`${r.name} ${r.email} ${r.company||""} ${r.service_interest||""}`.toLowerCase().includes(T.toLowerCase());return S&&$}),G=Math.max(1,Math.ceil(Q.length/m)),te=Math.min(R,G),de=Q.slice((te-1)*m,te*m),Se=()=>{const S=[["Name","Email","Phone","Company","Service","Consultation Requested","Status","Date","Message"],...Q.map(H=>[H.name,H.email,H.phone||"",H.company||"",H.service_interest||"",H.consultation_requested?"Yes":"No",H.status,new Date(H.created_at).toISOString(),(H.message||"").replace(/\n/g," ")])].map(H=>H.map(se=>`"${String(se).replace(/"/g,'""')}"`).join(",")).join(`
`),O=new Blob([S],{type:"text/csv;charset=utf-8;"}),$=URL.createObjectURL(O),B=document.createElement("a");B.href=$,B.download="contact_submissions.csv",B.click(),URL.revokeObjectURL($)},d=async()=>{try{const{data:r,error:S}=await f.from("admin_activity_logs").select("*").order("created_at",{ascending:!1}).limit(200);if(S)throw S;n(r||[])}catch{console.log("Activity logs unavailable; showing empty set"),n([])}};return a?e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[j&&e.jsx("img",{src:j,alt:"Logo",className:"h-8 w-auto rounded"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Panel"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{}),e.jsxs(w,{variant:"outline",onClick:C,children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),e.jsxs(Ie,{defaultValue:"submissions",className:"space-y-6",children:[e.jsxs(Te,{className:"grid w-full grid-cols-8",children:[e.jsxs(V,{value:"submissions",className:"flex items-center",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Contacts"]}),e.jsxs(V,{value:"hero-banners",className:"flex items-center",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Hero Banners"]}),e.jsxs(V,{value:"content",className:"flex items-center",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Page Content"]}),e.jsxs(V,{value:"footer",className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Footer"]}),e.jsxs(V,{value:"jobs",className:"flex items-center",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Job Openings"]}),e.jsxs(V,{value:"testimonials",className:"flex items-center",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Testimonials"]}),e.jsxs(V,{value:"settings",className:"flex items-center",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Site Settings"]}),e.jsxs(V,{value:"audit",className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Audit Logs"]})]}),e.jsxs(W,{value:"submissions",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(k,{children:e.jsxs(D,{className:"p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:g.length}),e.jsx("p",{className:"text-muted-foreground",children:"Total Submissions"})]})}),e.jsx(k,{children:e.jsxs(D,{className:"p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:g.filter(r=>r.status==="new").length}),e.jsx("p",{className:"text-muted-foreground",children:"New"})]})}),e.jsx(k,{children:e.jsxs(D,{className:"p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:g.filter(r=>r.status==="in_progress").length}),e.jsx("p",{className:"text-muted-foreground",children:"In Progress"})]})}),e.jsx(k,{children:e.jsxs(D,{className:"p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:g.filter(r=>r.consultation_requested).length}),e.jsx("p",{className:"text-muted-foreground",children:"Consultation Requests"})]})})]}),e.jsx(k,{children:e.jsxs(D,{className:"p-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{className:"px-2 py-1 border rounded",value:v,onChange:r=>{z(r.target.value),p(1)},children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx(E,{placeholder:"Search name, email, company, service",value:T,onChange:r=>{U(r.target.value),p(1)},className:"w-64"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(w,{variant:"outline",onClick:Se,children:"Export CSV"})})]})}),e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{children:["Contact Submissions (",Q.length,")"]})}),e.jsxs(D,{children:[e.jsxs(Ue,{children:[e.jsx($e,{children:e.jsxs(_e,{children:[e.jsx(Y,{children:"Name"}),e.jsx(Y,{children:"Contact"}),e.jsx(Y,{children:"Company"}),e.jsx(Y,{children:"Service"}),e.jsx(Y,{children:"Status"}),e.jsx(Y,{children:"Date"}),e.jsx(Y,{children:"Actions"})]})}),e.jsx(Be,{children:de.map(r=>e.jsxs(_e,{children:[e.jsx(K,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.name}),r.consultation_requested&&e.jsx(X,{variant:"secondary",className:"text-xs",children:"Consultation Requested"})]})}),e.jsx(K,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(De,{className:"h-3 w-3 mr-2"}),r.email]}),r.phone&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Qe,{className:"h-3 w-3 mr-2"}),r.phone]})]})}),e.jsx(K,{children:r.company&&e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(Ae,{className:"h-3 w-3 mr-2"}),r.company]})}),e.jsx(K,{children:r.service_interest&&e.jsx(X,{variant:"outline",className:"text-xs",children:r.service_interest})}),e.jsx(K,{children:e.jsxs("select",{value:r.status,onChange:S=>ee(r.id,S.target.value),className:"px-2 py-1 rounded text-xs border",children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"closed",children:"Closed"})]})}),e.jsx(K,{children:e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(fs,{className:"h-3 w-3 mr-2"}),new Date(r.created_at).toLocaleDateString()]})}),e.jsx(K,{children:e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{i({title:"Message",description:r.message})},children:e.jsx(vs,{className:"h-4 w-4"})})})]},r.id))})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",te," of ",G]}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>p(r=>Math.max(1,r-1)),disabled:te<=1,children:"Prev"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>p(r=>Math.min(G,r+1)),disabled:te>=G,children:"Next"})]})]})]})]}),e.jsx(W,{value:"hero-banners",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ye,{className:"h-5 w-5 mr-2"}),"Hero Banner Management"]})}),e.jsx(D,{children:e.jsx(Cs,{})})]})}),e.jsx(W,{value:"settings",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ee,{className:"h-5 w-5 mr-2"}),"Site Settings & Logo Management"]})}),e.jsx(D,{children:e.jsx($s,{})})]})}),e.jsx(W,{value:"content",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(qe,{className:"h-5 w-5 mr-2"}),"Page Content Management"]})}),e.jsx(D,{children:e.jsx(qs,{})})]})}),e.jsx(W,{value:"footer",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Footer Management"]})}),e.jsx(D,{children:e.jsx(Us,{})})]})}),e.jsx(W,{value:"jobs",children:e.jsx(Js,{})}),e.jsx(W,{value:"testimonials",children:e.jsx(Vs,{})}),e.jsx(W,{value:"audit",children:e.jsxs(k,{children:[e.jsx(P,{children:e.jsx(L,{children:"Admin Activity Logs"})}),e.jsx(D,{children:h.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"No logs to display."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ue,{children:[e.jsx($e,{children:e.jsxs(_e,{children:[e.jsx(Y,{children:"When"}),e.jsx(Y,{children:"User"}),e.jsx(Y,{children:"Action"}),e.jsx(Y,{children:"Resource"}),e.jsx(Y,{children:"IP"}),e.jsx(Y,{children:"User Agent"})]})}),e.jsx(Be,{children:h.map(r=>e.jsxs(_e,{children:[e.jsx(K,{children:new Date(r.created_at).toLocaleString()}),e.jsx(K,{children:r.user_email}),e.jsx(K,{children:e.jsx(X,{children:r.action})}),e.jsx(K,{children:r.resource||"-"}),e.jsx(K,{className:"text-xs text-muted-foreground",children:r.ip_address||"-"}),e.jsx(K,{className:"text-xs text-muted-foreground max-w-[240px] truncate",children:r.user_agent||"-"})]},r.id))})]})})})]})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-6",children:e.jsxs(k,{className:"w-full max-w-md",children:[e.jsx(P,{children:e.jsx(L,{className:"text-center",children:"Admin Login"})}),e.jsx(D,{children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"email",children:"Email"}),e.jsx(E,{id:"email",type:"email",value:t,onChange:r=>u(r.target.value),placeholder:"Enter admin email",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"password",children:"Password"}),e.jsx(E,{id:"password",type:"password",value:b,onChange:r=>F(r.target.value),placeholder:"Enter password",required:!0})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:A,children:A?"Logging in...":"Login"})]})})]})})};export{ca as default};
